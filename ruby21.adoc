IiU -- Ruby 2.1.3, Rails 4.2
============================
Installation in Ubuntu — khkoether[at]kahweb[dot]de

:icons:
:Author Initials: khk
:creativecommons-url: http://creativecommons.org/licenses/by/4.0/deed.de
:mit-url:             http://opensource.org/licenses/mit-license.php  
:ubuntu-url:          http://www.ubuntu.com/
:asciidoctor-url:     http://asciidoctor.org/
:asciidoctordocs-url: http://asciidoctor.org/docs/
:git-url:             http://git-scm.com/
:git-download-url:    https://www.kernel.org/pub/software/scm/git/

:ruby-url:            https://www.ruby-lang.org/de/
:ruby-download-url:   https://www.ruby-lang.org/de/downloads/
:rubyonrails-url:     http://www.rubyonrails.org

:ruby-version:        2.1.3
:ruby21_1st-url:      link:ruby21_1st.html

Version 3.0.1, Oktober 2014


Abstract
--------
Dieser Artikel ist eine Schritt-für-Schritt Anleitung zur Installation 
von {ruby-url}[Ruby 2.1.3] aus dem QuellCode.
 
Die Programmiersprache {ruby-url}[Ruby] ist die Grundlage für das 
Framework {rubyonrails-url}[Ruby on Rails].

Der Artikel ist in {asciidoctordocs-url}[AsciiDoc] geschrieben 
und mit _Asciidoctor 1.5.1_ erstellt worden.

[CAUTION]
====
Zu beachten ist, dass so ein Dokument zum Einen nie abschliessend 
sein kann, und zum Anderen bestimmte Konfigurationen anders, oder 
auf einem anderem Weg durchgeführt werden können. 
Gerne nehme ich Verbesserungsvorschläge entgegen.

Es gilt wie immer: Verwendung der Anleitung auf eigene Gefahr.
====


Vorraussetzung
--------------
Die Installation wird für {ubuntu-url}[Ubuntu 14.04 LTS (Trusty Tahr)] 
beschrieben. +
Gleichwohl sind die einzelnen Schritte auch für 
andere Debian-basierte GNU/Linux Distributionen übertragbar.

[TIP]
====
Ubuntu 14.04 LTS (Trusty Tahr) enthält kein Paket zu _Ruby 2.1_!
====


Download
--------
* {ruby-download-url}[Ruby 2.1.3] +    
  +ruby-{ruby-version}.tar.gz+  (ca. 15M) +
  2014-09-18 (Release date)

[NOTE] 
====
Das Kompilieren der Programmiersprache Ruby wird vom Benutzer 'sid' durchgeführt. +
Die eigentliche Installation von Ruby und Ruby on Rails wird vom 
Benutzer 'root' für das System durchgeführt.
----
$ ls -l 
-rw-rw-r-- 1 sid sid 15129183 Sep 28 14:47 ruby-2.1.3.tar.gz
----
====

[NOTE] 
====
Vor der eigentlichen Installation müssen die fehlenden 
Programm-Pakete installiert sind.
----
$ sudo apt-get install ...
               build-essential libc6-dev  g++  make  dpkg-dev  
               libssl-dev libmysqlclient-dev libsqlite3-dev    
               libreadline-dev libyaml-dev zlib1g-dev
               libltdl-dev libtool
----
====


Installation: Ruby {ruby-version}
---------------------------------
Zusätzliche Software-Pakete  
sollten im Verzeichnis +/opt+ (Optional) installiert werden. 

[IMPORTANT]
====
Ohne die Angabe eines Verzeichnisses wird +/usr/local/...+ automatisch verwendet. +
Eine bereits vorhandene Ruby-Installation wird überschrieben.   

Beispiel für die Änderung des Installations-Verzeichnisses: +
+./configure --prefix=/opt/wo_auch_immer+
====

*Step 1:* Auspacken des Source-Code
----
$ tar xvzf ruby-2.1.3.tar.gz
$ cd ruby-2.1.3
----

*Step 2:* Ziel-Verzeichnis anlegen, Konfiguration erstellen und kompilieren
----
$ sudo mkdir -p /opt/Ruby/ruby-2.1.3
----

----
$ ./configure --prefix=/opt/Ruby/ruby-2.1.3 | tee ../log.ruby_configure
checking build system type... x86_64-unknown-linux-gnu
checking host system type... x86_64-unknown-linux-gnu
checking target system type... x86_64-unknown-linux-gnu
checking for gcc... gcc
[...]
.ext/include/x86_64-linux/ruby/config.h updated
ruby library version = 2.1.0          <1>
configure: creating ./config.status
config.status: creating GNUmakefile
config.status: creating Makefile
config.status: creating ruby-2.1.pc
----
<1> Endlich stimmig.

----
$ make all | tee ../log.ruby_make-all
	CC = gcc
	LD = ld
	LDSHARED = gcc -shared
	CFLAGS = -O3 -fno-fast-math -ggdb3 
	         -Wall -Wextra -Wno-unused-parameter -Wno-parentheses -Wno-long-long 
	         -Wno-missing-field-initializers -Wunused-variable -Wpointer-arith 
	         -Wwrite-strings -Wdeclaration-after-statement -Wimplicit-function-declaration 
	         -ansi -std=iso9899:199409 
	XCFLAGS = -D_FORTIFY_SOURCE=2 -fstack-protector -fno-strict-overflow -fvisibility=hidden 
	          -DRUBY_EXPORT -fPIE
	CPPFLAGS =   -I. -I.ext/include/x86_64-linux -I./include -I.
	DLDFLAGS = -fstack-protector -pie  
	SOLIBS = 
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/4.8/lto-wrapper
Target: x86_64-linux-gnu
Configured with: ...	
[...]
compiling eval.c
In file included from eval.c:14:0:
eval_jump.c: In function ‘rb_exec_end_proc’:
eval_intern.h:135:34: warning: ‘_th’ may be used uninitialized in this function [-Wmaybe-uninitialized]
 #define TH_PUSH_TAG2() (_th->tag = &_tag, 0)
                                  ^   <1>
[...]
Generating RDoc documentation   
Generating RI format into /yggdrasil/TrustyTahr/Ruby21/ruby-2.1.3/.ext/rdoc...

  Files:        962

  Classes:     1414 ( 566 undocumented)
  Modules:      268 (  87 undocumented)
  Constants:   2098 ( 624 undocumented)
  Attributes:  1146 ( 272 undocumented)
  Methods:    10651 (2228 undocumented)

  Total:      15577 (3777 undocumented)
   75.75% documented

  Elapsed: 118.3s
----
<1> Beim Kompilieren des Sourcecode werden Warnungen angezeigt.

----
$ make test | tee ../log.ruby_make-test
sample/test.rb:assignment ...................[...viele...]   <1>
sample/test.rb:condition ..
sample/test.rb:if/unless ...
sample/test.rb:case .....
[...]
sample/test.rb:gc ....OK 4

test succeeded
PASS all 1008 tests
./miniruby -I./lib -I. -I.ext/common  ./tool/runruby.rb --extout=.ext  
                       -- --disable-gems "./bootstraptest/runner.rb" 
                          --ruby="ruby --disable-gems"   ./KNOWNBUGS.rb
2014-09-28 17:25:12 +0200
Driver is ruby 2.1.3p242 (2014-09-19 revision 47630) [x86_64-linux]
Target is ruby 2.1.3p242 (2014-09-19 revision 47630) [x86_64-linux]

KNOWNBUGS.rbPASS 0
No tests, no problem   <2>
----
<1> Jeder ausgegebene _._ (Punkt) ist ein ausgeführter Test.
<2> Wortwörtlich: Das sind _known_bugs_ ;-) -- aktuell, keiner.

[NOTE]
====
Auf die folgenden Teile des Ruby-Interpreters verzichte ich in meiner
Installation. Sollten Sie sie benötigen, +
müssen die entsprechenden
Entwickler-Bibliotheken (libNAME-dev) zusätzlich installiert werden. 
 
Führen Sie anschließend die obigen Befehle (make ...) erneut aus.
----
$ grep Failed ../log.ruby_make-all
Failed to configure -test-/win32/dln. It will not be installed.
Failed to configure -test-/win32/dln/empty. It will not be installed.
Failed to configure -test-/win32/fd_setsize. It will not be installed.
Failed to configure dbm. It will not be installed.
Failed to configure fiddle. It will not be installed.
Failed to configure gdbm. It will not be installed.
Failed to configure tk. It will not be installed.
Failed to configure tk/tkutil. It will not be installed.
Failed to configure win32. It will not be installed.
Failed to configure win32ole. It will not be installed.
----
====

*Step 3:* Installation (als Benutzer 'root') + 
(Dokumentation wird mitinstalliert: install-doc entfällt)
----
$ sudo make install | tee ../log.ruby_make-install
[...]
Generating RDoc documentation

No newer files.

  Files:      0

  Classes:    0 (0 undocumented)
  Modules:    0 (0 undocumented)
  Constants:  0 (0 undocumented)
  Attributes: 0 (0 undocumented)
  Methods:    0 (0 undocumented)

  Total:      0 (0 undocumented)
    0.00% documented

  Elapsed: 0.0s

./miniruby -I./lib -I. -I.ext/common  ./tool/runruby.rb --extout=.ext  -- --disable-gems -r./x86_64-linux-fake ./tool/rbinstall.rb --make="make" --dest-dir="" --extout=".ext" --mflags="" --make-flags="" --data-mode=0644 --prog-mode=0755 --installed-list .installed.list --mantype="doc" --install=all --rdoc-output=".ext/rdoc"
installing binary commands:   /opt/Ruby/ruby-2.1.3/bin
installing base libraries:    /opt/Ruby/ruby-2.1.3/lib
installing arch files:        /opt/Ruby/ruby-2.1.3/lib/ruby/2.1.0/x86_64-linux
installing pkgconfig data:    /opt/Ruby/ruby-2.1.3/lib/pkgconfig
installing command scripts:   /opt/Ruby/ruby-2.1.3/bin
installing library scripts:   /opt/Ruby/ruby-2.1.3/lib/ruby/2.1.0
installing common headers:    /opt/Ruby/ruby-2.1.3/include/ruby-2.1.0
installing manpages:          /opt/Ruby/ruby-2.1.3/share/man/man1
installing extension objects: /opt/Ruby/ruby-2.1.3/lib/ruby/2.1.0/x86_64-linux
installing extension objects: /opt/Ruby/ruby-2.1.3/lib/ruby/site_ruby/2.1.0/x86_64-linux
installing extension objects: /opt/Ruby/ruby-2.1.3/lib/ruby/vendor_ruby/2.1.0/x86_64-linux
installing extension headers: /opt/Ruby/ruby-2.1.3/include/ruby-2.1.0/x86_64-linux
installing extension scripts: /opt/Ruby/ruby-2.1.3/lib/ruby/2.1.0
installing extension scripts: /opt/Ruby/ruby-2.1.3/lib/ruby/site_ruby/2.1.0
installing extension scripts: /opt/Ruby/ruby-2.1.3/lib/ruby/vendor_ruby/2.1.0
installing extension headers: /opt/Ruby/ruby-2.1.3/include/ruby-2.1.0/ruby
installing default gems:      /opt/Ruby/ruby-2.1.3/lib/ruby/gems/2.1.0 (build_info, cache, doc, extensions, gems, specifications)
                              bigdecimal 1.2.4
                              io-console 0.4.2
                              json 1.8.1
                              minitest 4.7.5
                              psych 2.0.5
                              rake 10.1.0
                              rdoc 4.1.0
                              test-unit 2.1.3.0
installing rdoc:              /opt/Ruby/ruby-2.1.3/share/ri/2.1.0/system
installing capi-docs:         /opt/Ruby/ruby-2.1.3/share/doc/ruby
----

*Step 4:* Installation verifizieren
----
$ cd /opt/Ruby/ruby-2.1.3
$ ls -l
drwxr-xr-x 2 root root 4096 Sep 28 17:28 bin
drwxr-xr-x 3 root root 4096 Sep 28 17:28 include
drwxr-xr-x 4 root root 4096 Sep 28 17:28 lib
drwxr-xr-x 5 root root 4096 Sep 28 17:35 share
----

----
$ ls -l bin
-rwxr-xr-x 1 root root     4409 Sep 28 17:28 erb
-rwxr-xr-x 1 root root      558 Sep 28 17:28 gem
-rwxr-xr-x 1 root root      202 Sep 28 17:28 irb
-rwxr-xr-x 1 root root     1256 Sep 28 17:28 rake
-rwxr-xr-x 1 root root      950 Sep 28 17:28 rdoc
-rwxr-xr-x 1 root root      200 Sep 28 17:28 ri
-rwxr-xr-x 1 root root 14070326 Sep 28 17:20 ruby
-rwxr-xr-x 1 root root       90 Sep 28 17:28 testrb
----

*Step 5:* Der Pfad zum Verzeichnis +/opt/Ruby/ruby-{ruby-version}/bin+ muß gesetzt werden. 
----
$ cd /opt/Ruby/
$ sudo ln -s ruby-2.1.3 current

$ ls -l
-rw-r--r-- 1 sid  sid  266240 Mär  3  2014 asciidoctor-1.5.0.preview3.gem
lrwxrwxrwx 1 root root     15 Sep 28 14:28 current19 -> ruby-1.9.3-p547
lrwxrwxrwx 1 root root     15 Mär  3  2014 current20 -> ruby-2.0.0-p451
lrwxrwxrwx 1 root root     10 Sep 28 17:37 current21 -> ruby-2.1.3
drwxr-xr-x 7 root root   4096 Mär  3  2014 ruby-1.9.3-p545
drwxr-xr-x 7 root root   4096 Sep 28 14:45 ruby-1.9.3-p547
-rw-r--r-- 1 root root     47 Mär  3  2014 ruby19.path.sh
drwxr-xr-x 7 root root   4096 Mär  3  2014 ruby-2.0.0-p451
-rw-r--r-- 1 root root     47 Mär  3  2014 ruby20.path.sh
drwxr-xr-x 6 root root   4096 Sep 28 17:28 ruby-2.1.3
-rw-r--r-- 1 root root     47 Sep 28 17:38 ruby21.path.sh
----

.Lokal in der aktuellen Shell (1)
Erstellen Sie eine Datei +ruby19.path.sh+.  
----
$ sudo vim ruby21.path.sh
PATH=/opt/Ruby/current21/bin:$PATH
export PATH
----

[NOTE] 
=========================================================
Achtung: Ausführen der Datei mit dem Punkt-Operator!
----
$ . ruby21.path.sh   <1>
---- 
<1> Oder mit dem Bash-Builtin Kommando: _source ruby21.path.sh_
=========================================================

.Systemweit in der Datei +/etc/environment+ (2)
----
$ sudo vim /etc/environment
PATH="/opt/Ruby/current21/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
----


*Step 6:* Check

.Die Ruby-Version ...
----
$ which ruby
/opt/Ruby/current21/bin/ruby   <1>

$ sudo which ruby              <2>
/opt/Ruby/current21/bin/ruby

$ ruby -v                      <3>
ruby 2.1.3p242 (2014-09-19 revision 47630) [x86_64-linux]
----
<1> Das Kommando 'which' wertet den gesetzten +PATH+ für den Benutzer 'sid' aus +
<2> Das Kommando 'which' wertet den gesetzten +PATH+ für den Benuzter 'root' aus
<3> Ausgabe der Version des installierten Ruby


.Vollständigkeit ...
----
$ ruby -ropenssl -rzlib -rreadline -e "puts 'Happy new Ruby'"
Happy new Ruby
----

.Ruby 2.1: _irb_
----
$ irb
irb(main):001:0> RUBY_VERSION
=> "2.1.3"
irb(main):002:0> RUBY_PATCHLEVEL
=> 242
irb(main):003:0> Time.now.to_s
=> "2014-09-28 17:42:25 +0200"
irb(main):004:0> Time.now.friday?
=> false
irb(main):005:0> Time.now.sunday?
=> true
irb(main):006:0> exit
----

.ri - Ruby Interactive (Test der installierten Dokumentation)
----
$ ri Array#each
----

----
= Array#each

(from ruby core)
 -----------------------------------------------------------------------------
  ary.each {|item| block }   -> ary
  ary.each                   -> an_enumerator
   

 -----------------------------------------------------------------------------

Calls block once for each element in self, passing that element as a
parameter.

If no block is given, an enumerator is returned instead.

  a = [ "a", "b", "c" ]
  a.each {|x| print x, " -- " }

produces:

  a -- b -- c --
----


Rubygems Aktualisierung
-----------------------
_RubyGems_ (oder kurz Gems) ist das offizielle Paketsystem für die 
Programmiersprache Ruby. Mit ihm hat der Anwender die Möglichkeit, 
mehrere (zum Beispiel ältere oder jüngere) Versionen eines Programmes, 
Programmteiles oder einer Bibliothek gesteuert nach Bedarf einzurichten, 
zu verwalten oder auch wieder zu entfernen. +
&rarr; http://de.wikipedia.org/wiki/RubyGems[Wikipedia: RubyGems]

[NOTE]
====
Die Aktualisierung der Ruby2.1-Installation wird mit dem 
Benutzer 'root' durchgeführt.
====

*Step 1:* Vorraussetzung für die nächsten Befehle ist ein 
funktionierender +PATH+-Eintrag für alle Benutzer (einschliesslich 'root') 
auf die Ruby2.1-Installation:
----
$ which gem
/opt/Ruby/current21/bin/gem

$ sudo su -
# . /opt/Ruby/ruby21.path.sh
# which gem
/opt/Ruby/current21/bin/gem
----

Dann gehen auch die folgenden Befehle
----
$ gem -v
2.2.2

$ gem list --local

*** LOCAL GEMS ***

bigdecimal (1.2.4)
io-console (0.4.2)
json (1.8.1)
minitest (4.7.5)
psych (2.0.5)
rake (10.1.0)
rdoc (4.1.0)
test-unit (2.1.3.0)
----

*Step 2:* Das Programm 'gem' wird nicht aktualisiert ...

NOTE: RubyGems 2.4.x enthält Fehler im Zusammenhang mit Rails 4.2.x
 
*Step 3:* Installierte RubyGems aktualisieren
----
# gem update
Updating installed gems
Updating bigdecimal
Fetching: bigdecimal-1.2.5.gem (100%)
Building native extensions.  This could take a while...
Successfully installed bigdecimal-1.2.5
Parsing documentation for bigdecimal-1.2.5
Installing ri documentation for bigdecimal-1.2.5
Installing darkfish documentation for bigdecimal-1.2.5
Done installing documentation for bigdecimal after 2 seconds
Updating minitest
Fetching: minitest-5.4.2.gem (100%)
Successfully installed minitest-5.4.2
Parsing documentation for minitest-5.4.2
Installing ri documentation for minitest-5.4.2
Installing darkfish documentation for minitest-5.4.2
Done installing documentation for minitest after 2 seconds
Updating psych
Fetching: psych-2.0.6.gem (100%)
Building native extensions.  This could take a while...
Successfully installed psych-2.0.6
Parsing documentation for psych-2.0.6
Installing ri documentation for psych-2.0.6
Installing darkfish documentation for psych-2.0.6
Done installing documentation for psych after 1 seconds
Updating rake
Fetching: rake-10.3.2.gem (100%)
rake's executable "rake" conflicts with /opt/Ruby/ruby-2.1.3/bin/rake
Overwrite the executable? [yN]  y    <1>
Successfully installed rake-10.3.2
Parsing documentation for rake-10.3.2
Installing ri documentation for rake-10.3.2
Installing darkfish documentation for rake-10.3.2
Done installing documentation for rake after 3 seconds
Updating rdoc
Fetching: rdoc-4.1.2.gem (100%)
rdoc's executable "rdoc" conflicts with /opt/Ruby/ruby-2.1.3/bin/rdoc
Overwrite the executable? [yN]  y
rdoc's executable "ri" conflicts with /opt/Ruby/ruby-2.1.3/bin/ri
Overwrite the executable? [yN]  y
Depending on your version of ruby, you may need to install ruby rdoc/ri data:

<= 1.8.6 : unsupported
 = 1.8.7 : gem install rdoc-data; rdoc-data --install
 = 1.9.1 : gem install rdoc-data; rdoc-data --install
>= 1.9.2 : nothing to do! Yay!
Successfully installed rdoc-4.1.2
Parsing documentation for rdoc-4.1.2
Installing ri documentation for rdoc-4.1.2
Installing darkfish documentation for rdoc-4.1.2
Done installing documentation for rdoc after 16 seconds
Updating test-unit
Fetching: power_assert-0.1.4.gem (100%)
Successfully installed power_assert-0.1.4
Fetching: test-unit-3.0.1.gem (100%)
Successfully installed test-unit-3.0.1
Parsing documentation for power_assert-0.1.4
Installing ri documentation for power_assert-0.1.4
Installing darkfish documentation for power_assert-0.1.4
Parsing documentation for test-unit-3.0.1
Installing ri documentation for test-unit-3.0.1
Installing darkfish documentation for test-unit-3.0.1
Done installing documentation for power_assert, test-unit after 4 seconds
Gems updated: bigdecimal minitest psych rake rdoc power_assert test-unit    <2>
----
<1> Ich wähle die jeweils aktuellste Version: _y_
<2> Sieben _Gems_ aktualisiert!

----
# gem list --local

*** LOCAL GEMS ***

bigdecimal (1.2.5, 1.2.4)
io-console (0.4.2)
json (1.8.1)
minitest (5.4.2, 4.7.5)
power_assert (0.1.4)
psych (2.0.6, 2.0.5)
rake (10.3.2, 10.1.0)
rdoc (4.1.2, 4.1.0)
test-unit (3.0.1, 2.1.3.0)
----

*Step 4:* Dokumentation zu den installierten RubyGems aktualisieren
----
# cd /opt/Ruby/current21   <1>  
# rdoc .
Parsing sources...
Couldn't find file to include 'README.txt' from lib/ruby/2.1.0/minitest/unit.rb 
Couldn't find file to include 'README.txt' from lib/ruby/gems/2.1.0/gems/minitest-5.4.2/lib/minitest.rb
100% [19054/19054]  share/ri/2.1.0/system/unknown/cdesc-unknown.ri        
                
Generating Darkfish format into /opt/Ruby/ruby-2.1.3/doc...   <2>

  Files:      19054

  Classes:     1553 ( 847 undocumented)
  Modules:      272 ( 117 undocumented)
  Constants:    996 ( 617 undocumented)
  Attributes:  1226 ( 385 undocumented)
  Methods:     9143 (3807 undocumented)

  Total:      13190 (5773 undocumented)
   56.23% documented

  Elapsed: 581.2s   <2>
----
<1> Entspricht: _/opt/Ruby/ruby-2.1.3_
<2> _Generating Darkfish_ dauert lange...

----
# ls -l
drwxr-xr-x  2 root root  4096 Sep 28 17:47 bin
drwxr-xr-x 91 root root 16384 Sep 28 18:01 doc       <1>
drwxr-xr-x  3 root root  4096 Sep 28 17:28 include
drwxr-xr-x  4 root root  4096 Sep 28 17:28 lib
drwxr-xr-x  5 root root  4096 Sep 28 17:35 share
----
<1> Das Dokumentations-Verzeichnis enthält die Datei _index.html_. +
    Das neue Verzeichnis belegt ca. 115M Speicherplatz.

----
Browser> file:///opt/Ruby/current21/doc/index.html
----


Installation: Ruby on Rails 4.2.0.beta1
---------------------------------------
*Step 0* 
----
# gem search ^rails$ --remote

*** REMOTE GEMS ***

rails (4.1.6)   <1>
----
<1> Aktuell neueste Version von Rails. +
    Ich installiere aber die oben genannte Version 4.2.0.beta1!

[TIP]
====
Die Installation der Dokumentation kann ausgelassen werden.
----
# gem install rails --pre --no-rdoc --no-ri
----  
====

*Step 1:* Wichtig ist hier die Systemweite Installation von 
Rails 4.2.0.beta1 mit dem Benutzer 'root'.
---- 
# gem install rails --pre
Fetching: thread_safe-0.3.4.gem (100%)
Successfully installed thread_safe-0.3.4
Fetching: tzinfo-1.2.2.gem (100%)
Successfully installed tzinfo-1.2.2
Fetching: i18n-0.7.0.beta1.gem (100%)
Successfully installed i18n-0.7.0.beta1
Fetching: activesupport-4.2.0.beta1.gem (100%)
Successfully installed activesupport-4.2.0.beta1
Fetching: rails-deprecated_sanitizer-1.0.3.gem (100%)
Successfully installed rails-deprecated_sanitizer-1.0.3
Fetching: mini_portile-0.6.0.gem (100%)
Successfully installed mini_portile-0.6.0
Fetching: nokogiri-1.6.3.1.gem (100%)
Building native extensions.  This could take a while...
Building nokogiri using packaged libraries.
Building libxml2-2.8.0 for nokogiri with the following patches applied:
	- 0001-Fix-parser-local-buffers-size-problems.patch
	- 0002-Fix-entities-local-buffers-size-problems.patch
	- 0003-Fix-an-error-in-previous-commit.patch
	- 0004-Fix-potential-out-of-bound-access.patch
	- 0005-Detect-excessive-entities-expansion-upon-replacement.patch
	- 0006-Do-not-fetch-external-parsed-entities.patch
	- 0007-Enforce-XML_PARSER_EOF-state-handling-through-the-pa.patch
	- 0008-Improve-handling-of-xmlStopParser.patch
	- 0009-Fix-a-couple-of-return-without-value.patch
	- 0010-Keep-non-significant-blanks-node-in-HTML-parser.patch
	- 0011-Do-not-fetch-external-parameter-entities.patch
 ************************************************************************
IMPORTANT!  Nokogiri builds and uses a packaged version of libxml2.

If this is a concern for you and you want to use the system library
instead, abort this installation process and reinstall nokogiri as
follows:

    gem install nokogiri -- --use-system-libraries

If you are using Bundler, tell it to use the option:

    bundle config build.nokogiri --use-system-libraries
    bundle install

However, note that nokogiri does not necessarily support all versions
of libxml2.

For example, libxml2-2.9.0 and higher are currently known to be broken
and thus unsupported by nokogiri, due to compatibility problems and
XPath optimization bugs.
 ************************************************************************
Building libxslt-1.1.28 for nokogiri with the following patches applied:
	- 0001-Adding-doc-update-related-to-1.1.28.patch
	- 0002-Fix-a-couple-of-places-where-f-printf-parameters-wer.patch
	- 0003-Initialize-pseudo-random-number-generator-with-curre.patch
	- 0004-EXSLT-function-str-replace-is-broken-as-is.patch
	- 0006-Fix-str-padding-to-work-with-UTF-8-strings.patch
	- 0007-Separate-function-for-predicate-matching-in-patterns.patch
	- 0008-Fix-direct-pattern-matching.patch
	- 0009-Fix-certain-patterns-with-predicates.patch
	- 0010-Fix-handling-of-UTF-8-strings-in-EXSLT-crypto-module.patch
	- 0013-Memory-leak-in-xsltCompileIdKeyPattern-error-path.patch
	- 0014-Fix-for-bug-436589.patch
	- 0015-Fix-mkdir-for-mingw.patch
 ************************************************************************
IMPORTANT!  Nokogiri builds and uses a packaged version of libxslt.

If this is a concern for you and you want to use the system library
instead, abort this installation process and reinstall nokogiri as
follows:

    gem install nokogiri -- --use-system-libraries

If you are using Bundler, tell it to use the option:

    bundle config build.nokogiri --use-system-libraries
    bundle install
 ************************************************************************
Successfully installed nokogiri-1.6.3.1
Fetching: rails-dom-testing-1.0.3.gem (100%)
Successfully installed rails-dom-testing-1.0.3
Fetching: erubis-2.7.0.gem (100%)
Successfully installed erubis-2.7.0
Fetching: builder-3.2.2.gem (100%)
Successfully installed builder-3.2.2
Fetching: actionview-4.2.0.beta1.gem (100%)
Successfully installed actionview-4.2.0.beta1
Fetching: rack-1.6.0.beta.gem (100%)
Successfully installed rack-1.6.0.beta
Fetching: rack-test-0.6.2.gem (100%)
Successfully installed rack-test-0.6.2
Fetching: actionpack-4.2.0.beta1.gem (100%)
Successfully installed actionpack-4.2.0.beta1
Fetching: activemodel-4.2.0.beta1.gem (100%)
Successfully installed activemodel-4.2.0.beta1
Fetching: arel-6.0.0.beta1.gem (100%)
Successfully installed arel-6.0.0.beta1
Fetching: activerecord-4.2.0.beta1.gem (100%)
Successfully installed activerecord-4.2.0.beta1
Fetching: mime-types-2.3.gem (100%)
Successfully installed mime-types-2.3
Fetching: mail-2.6.1.gem (100%)
Successfully installed mail-2.6.1
Fetching: actionmailer-4.2.0.beta1.gem (100%)
Successfully installed actionmailer-4.2.0.beta1
Fetching: globalid-0.3.0.gem (100%)
Successfully installed globalid-0.3.0
Fetching: activejob-4.2.0.beta1.gem (100%)
Successfully installed activejob-4.2.0.beta1
Fetching: thor-0.19.1.gem (100%)
Successfully installed thor-0.19.1
Fetching: railties-4.2.0.beta1.gem (100%)
Successfully installed railties-4.2.0.beta1
Fetching: bundler-1.7.3.gem (100%)
Successfully installed bundler-1.7.3
Fetching: tilt-1.4.1.gem (100%)
Successfully installed tilt-1.4.1
Fetching: multi_json-1.10.1.gem (100%)
Successfully installed multi_json-1.10.1
Fetching: hike-1.2.3.gem (100%)
Successfully installed hike-1.2.3
Fetching: sprockets-2.12.2.gem (100%)
Successfully installed sprockets-2.12.2
Fetching: sprockets-rails-3.0.0.beta1.gem (100%)
Successfully installed sprockets-rails-3.0.0.beta1
Fetching: rails-4.2.0.beta1.gem (100%)
Successfully installed rails-4.2.0.beta1
Parsing documentation for actionmailer-4.2.0.beta1      
Installing ri documentation for actionmailer-4.2.0.beta1
Parsing documentation for actionmailer-4.2.0.beta1
Installing ri documentation for actionmailer-4.2.0.beta1
Parsing documentation for actionpack-4.2.0.beta1
Installing ri documentation for actionpack-4.2.0.beta1
Parsing documentation for actionview-4.2.0.beta1
Installing ri documentation for actionview-4.2.0.beta1
Parsing documentation for activejob-4.2.0.beta1
Installing ri documentation for activejob-4.2.0.beta1
Parsing documentation for activemodel-4.2.0.beta1
Installing ri documentation for activemodel-4.2.0.beta1
Parsing documentation for activerecord-4.2.0.beta1
Installing ri documentation for activerecord-4.2.0.beta1
Parsing documentation for activesupport-4.2.0.beta1
Installing ri documentation for activesupport-4.2.0.beta1
Parsing documentation for arel-6.0.0.beta1
Installing ri documentation for arel-6.0.0.beta1
Parsing documentation for builder-3.2.2
Installing ri documentation for builder-3.2.2
Parsing documentation for bundler-1.7.3
Installing ri documentation for bundler-1.7.3
Parsing documentation for erubis-2.7.0
Installing ri documentation for erubis-2.7.0
Parsing documentation for globalid-0.3.0
Installing ri documentation for globalid-0.3.0
Parsing documentation for hike-1.2.3
Installing ri documentation for hike-1.2.3
Parsing documentation for i18n-0.7.0.beta1
Installing ri documentation for i18n-0.7.0.beta1
Parsing documentation for mail-2.6.1
Installing ri documentation for mail-2.6.1
Parsing documentation for mime-types-2.3
Installing ri documentation for mime-types-2.3
Parsing documentation for mini_portile-0.6.0
Installing ri documentation for mini_portile-0.6.0
Parsing documentation for multi_json-1.10.1
Installing ri documentation for multi_json-1.10.1
Parsing documentation for nokogiri-1.6.3.1
Installing ri documentation for nokogiri-1.6.3.1
Parsing documentation for rack-1.6.0.beta
Installing ri documentation for rack-1.6.0.beta
Parsing documentation for rack-test-0.6.2
Installing ri documentation for rack-test-0.6.2
Parsing documentation for rails-4.2.0.beta1
Installing ri documentation for rails-4.2.0.beta1
Parsing documentation for rails-deprecated_sanitizer-1.0.3
Installing ri documentation for rails-deprecated_sanitizer-1.0.3
Parsing documentation for rails-dom-testing-1.0.3
Installing ri documentation for rails-dom-testing-1.0.3
Parsing documentation for railties-4.2.0.beta1
Installing ri documentation for railties-4.2.0.beta1
Parsing documentation for sprockets-2.12.2
Installing ri documentation for sprockets-2.12.2
Parsing documentation for sprockets-rails-3.0.0.beta1
Installing ri documentation for sprockets-rails-3.0.0.beta1
Parsing documentation for thor-0.19.1
Installing ri documentation for thor-0.19.1
Parsing documentation for thread_safe-0.3.4
Installing ri documentation for thread_safe-0.3.4
Parsing documentation for tilt-1.4.1
Installing ri documentation for tilt-1.4.1
Parsing documentation for tzinfo-1.2.2
Installing ri documentation for tzinfo-1.2.2
Done installing documentation for 
  actionmailer, actionpack, actionview, activejob, activemodel, activerecord, activesupport, 
  arel, builder, bundler, erubis, globalid, hike, i18n, mail, mime-types, mini_portile, 
  multi_json, nokogiri, rack, rack-test, rails, rails-deprecated_sanitizer, rails-dom-testing, 
  railties, sprockets, sprockets-rails, thor, thread_safe, tilt, tzinfo 
after 1369 seconds
31 gems installed   <1>
----
<1> Für das Framework _Ruby on Rails_ wurden 31 RubyGems installiert. +
    Hinweis: Weitere RubyGems müssen installiert werden (Datenbank-Treiber, Erweiterungen). 

[NOTE]
====
Alternativ kann _Rails_ mit der Angabe einer Version installiert werden.
----
# gem install rails --version 4.1.6

# gem install rails --version '~> 4.1.6'   <1>
----
<1> Twiddle Wakka: '~> 4.1.6' bedeutet, das die höchste Gem-Version von Rails +
    im Bereich von >= 4.1.6 und < 4.2 installiert wird. 
====

----
$ gem list --local 

*** LOCAL GEMS ***

actionmailer (4.2.0.beta1)
actionpack (4.2.0.beta1)
actionview (4.2.0.beta1)
activejob (4.2.0.beta1)
activemodel (4.2.0.beta1)
activerecord (4.2.0.beta1)
activesupport (4.2.0.beta1)
arel (6.0.0.beta1)
bigdecimal (1.2.5, 1.1.0)
builder (3.2.2)
bundler (1.7.3)
erubis (2.7.0)
globalid (0.3.0)
hike (1.2.3)
i18n (0.7.0.beta1)
io-console (0.4.2, 0.3)
json (1.8.1, 1.5.5)
mail (2.6.1)
mime-types (2.3)
mini_portile (0.6.0)
minitest (5.4.2, 2.5.1)
multi_json (1.10.1)
nokogiri (1.6.3.1)
rack (1.6.0.beta)
rack-test (0.6.2)
rails (4.2.0.beta1)
rails-deprecated_sanitizer (1.0.3)
rails-dom-testing (1.0.3)
railties (4.2.0.beta1)
rake (10.3.2, 0.9.2.2)
rdoc (4.1.2, 3.9.5)
rubygems-update (2.4.1, 2.2.2)
sprockets (2.12.2)
sprockets-rails (3.0.0.beta1)
thor (0.19.1)
thread_safe (0.3.4)
tilt (1.4.1)
tzinfo (1.2.2)
----

----
$ cd /opt/Ruby/current19
$ ls -l bin
-rwxr-xr-x 1 root root      513 Sep 28 15:38 bundle
-rwxr-xr-x 1 root root      514 Sep 28 15:38 bundler
-rwxr-xr-x 1 root root     4414 Sep 28 14:26 erb
-rwxr-xr-x 1 root root      510 Sep 28 15:37 erubis
-rwxr-xr-x 1 root root      563 Sep 28 14:26 gem
-rwxr-xr-x 1 root root      335 Sep 28 14:26 irb
-rwxr-xr-x 1 root root      518 Sep 28 15:37 nokogiri
-rwxr-xr-x 1 root root      504 Sep 28 15:37 rackup
-rwxr-xr-x 1 root root      515 Sep 28 15:38 rails
-rwxr-xr-x 1 root root      502 Sep 28 14:41 rake
-rwxr-xr-x 1 root root      502 Sep 28 14:41 rdoc
-rwxr-xr-x 1 root root      500 Sep 28 14:41 ri
-rwxr-xr-x 1 root root 10610012 Sep 28 14:22 ruby
-rwxr-xr-x 1 root root      522 Sep 28 15:38 sprockets
-rwxr-xr-x 1 root root      315 Sep 28 14:26 testrb
-rwxr-xr-x 1 root root      502 Sep 28 15:38 thor
-rwxr-xr-x 1 root root      502 Sep 28 15:38 tilt
-rwxr-xr-x 1 root root      546 Sep 28 14:42 update_rubygems
----

[NOTE]
====
Das Erstellen der Dokumentation (RDoc) müßte wiederholt werden... 
aber mit Rails (31 Gems) zusätzlich - ist sie für viele Partitionen (mit ca. 11GB)
 - halt zu groß ;-)
====

*Step 2:* Installation der Datenbank-Treiber mit dem Benutzer 'root'.
---- 
# gem install mysql2 --no-rdoc --no-ri
Fetching: mysql2-0.3.16.gem (100%)
Building native extensions.  This could take a while...
Successfully installed mysql2-0.3.16
1 gem installed
----

----
# gem install sqlite3 --no-rdoc --no-ri   <1>
Fetching: sqlite3-1.3.9.gem (100%)
Building native extensions.  This could take a while...
Successfully installed sqlite3-1.3.9
1 gem installed
----
<1> Rails ist für die Verwendung einer 'SQLite3'-Datenbank vorkonfiguriert. + 
    Klein, kompakt und dateibasiert – mit diesen Vorzügen glänzt 'SQLite3'. 
    Daher haben sich die Rails-Core-Entwickler für 'SQLite3' als 
    Default-Datenbank entschieden.
 
[NOTE]
====
Hello! The sqlite3-ruby gem has changed it's name to just sqlite3.  Rather than
installing `sqlite3-ruby`, you should install `sqlite3`.  Please update your
dependencies accordingly.

Thanks from the Ruby sqlite3 team!

<3 <3 <3 <3
====

*Step 3:* Erweiterungen
----
# gem install sinatra --no-rdoc --no-ri   <1>
Fetching: rack-protection-1.5.3.gem (100%)
Successfully installed rack-protection-1.5.3
Fetching: sinatra-1.4.5.gem (100%)
Successfully installed sinatra-1.4.5
2 gems installed
----
<1> Sinatra ist eine _freie_ und _open source Webapplikationsbibliothek_ und 
    eine in Ruby geschriebene _domänenspezifische_ Sprache. +
    Sinatra setzt das Rack Webserver-Interface voraus. +
    &rarr; http://de.wikipedia.org/wiki/Sinatra_%28Software%29[Wikipedia: Sinatra (Software)]

----
# gem install asciidoctor       <1>
Fetching: asciidoctor-1.5.1.gem (100%)
Successfully installed asciidoctor-1.5.1
1 gem installed
----
<1> *Asciidoctor* is an open source Ruby processor for converting AsciiDoc markup 
    into HTML 5, DocBook 4.5 and other formats.
    

RubyGems Documentation Index
----------------------------
Auf die installierte Dokumentation zugreifen.
----
# gem server
Server started at http://0.0.0.0:8808
----

----
Browser> http://localhost:8808/
         RubyGems Documentation Index   
----

image::images/ruby/rubygems19_documentation_index.jpeg[RubyGems 1.9 Documentation Index]


Beispiel
--------
{ruby21_1st-url}[Rails 4: Erste Schritte &hellip; mit Ruby]


Anhang
------
Script zum Installieren von Ruby {ruby-version} (ohne weitere Erläuterung).

.Datei: +ruby19-install.sh+
----
#!/bin/bash
#
ME=make_ruby_1.9.3
NAME=ruby-2.1.3
TARGET=/opt/Ruby/${NAME}

if [ ! -e $TARGET ] 
then
  echo "Ziel-Verzeichnis '$TARGET' existiert nicht."
  echo "Abbruch."
  exit 1
fi
echo "Ziel-Verzeichnis:"
ls -l $TARGET

echo "Ruby 1.9.3-Installation fortsetzen (j/n)"
read dummy
case $dummy in
  j|J|y|Y) echo "Installation wird fortgesetzt."
           ;;
  *) echo "Installation wird abgebrochen."
     exit 1
     ;;
esac

echo 
echo "Source auspacken ..."
tar xvzf ${NAME}.tar.gz
cd ${NAME}

echo 
echo "Source übersetzen ..."
./configure --prefix=$TARGET --enable-shared | tee ../log.ruby_configure
make all  | tee ../log.ruby_make-all 
make test | tee ../log.ruby_make-test

echo
echo "Ruby 1.9.3 installieren"
sudo make install | tee ../log.ruby_make-install

echo
ls -l $TARGET

echo 
echo "$ME: Ende."
----
