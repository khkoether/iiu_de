= IiU -- JRuby 9k
Installation in Ubuntu — sidoether[at]kahweb[dot]de

include::_bp_header.adoc[]

:java-home-url:          http://www.oracle.com/technetwork/java/javase/downloads/index.html
:ruby-home-url:          https://www.ruby-lang.org/de/
:jruby-home-url:         http://jruby.org/
:jruby-download-url:     http://jruby.org/download
:jruby-github-url:       https://github.com/jruby/jruby/

:rubyonrails-home-url:   http://rubyonrails.org

:jruby-version:          9.2.5.0

Version {version} {middot} {datum}


== Abstract
{ruby-home-url}[Ruby] ist eine dynamische, freie Programmiersprache,
die sich einfach anwenden und produktiv einsetzen lässt. +
{jruby-home-url}[JRuby] ist eine hochleistungsfähige, robuste,
voll-threadfähige Java-Implementierung der _Ruby_-Programmiersprache.

Dieser Artikel ist eine Schritt-für-Schritt Anleitung zur Installation
von {jruby-download-url}[JRuby 9k ({jruby-version})] unter GNU/Linux.

Die Programmiersprache {ruby-home-url}[Ruby] ist die Grundlage für das
Framework {rubyonrails-home-url}[Ruby on Rails].

_JRuby_ ist Open Source, wird gehostet auf {jruby-github-url}[GitHub]
und ist freigegeben unter drei Lizenzen: +
der {epl-url}[EPL 1.0], der {gpl-url}[GPL 2] und der {lgpl-url}[LGPL 2.1]. +
Einige Komponenten haben andere Lizenzen/ Copyright (siehe: https://github.com/jruby/jruby/blob/dcd060d9149b9c8c2beb1f3b1bf46b882f36fcc1/COPYING[COPYING]).

Der Artikel ist in _AsciiDoc_ geschrieben
und mit _Asciidoctor {asciidoctor-version}_ erstellt worden.

[CAUTION]
====
Zu beachten ist, dass so ein Dokument zum Einen nie abschliessend
sein kann, und zum Anderen bestimmte Konfigurationen anders, oder
auf einem anderem Weg durchgeführt werden können. +
Gerne nehme ich Verbesserungsvorschläge entgegen.

Es gilt wie immer: Verwendung der Anleitung auf eigene Gefahr.
====


== Vorraussetzungen
Die Installation wird für {ubuntu-url}[Ubuntu 18.04 LTS (Bionic Beaver)] beschrieben. +
Gleichwohl sind die einzelnen Schritte auch für
andere Debian-basierte GNU/Linux Distributionen übertragbar.

Die System-Installation des *OpenJDK* ist, wie in &nbsp; {jdk-url}[JDK] &nbsp;
beschrieben, durchgeführt worden.

[CAUTION]
====
Ubuntu 18.04 LTS (Bionic Beaver) enthält die Pakete::
  _jruby/bionic,bionic 9.1.13.0-1_all.deb_.

*Nicht installieren!*
====


== Download
* {jruby-download-url}[JRuby 9.2.5.0] +
  `jruby-dist-9.2.5.0-bin.tar.gz`  (ca. 23M) +
  *2018-12-06 (Release date)*

Release-Notes::
  JRuby 9.2.x is our new major version of JRuby. +
  It is expected to be compatible with Ruby 2.5.x and stay in sync with C Ruby. +
  JRuby 9.2.0.0 is our first release for 2.5 support.

[TIP]
.Historisches
====
Die neue _JRuby-Version 9.0.0.0_ wurde am 22.07.2015 mit bestimmten Zielen veröffentlicht:

. Ruby 2.2 support
. New optimizing runtime
. New POSIX-friendly IO an Process
====


== Installation
Für die Verwaltung der *Ruby*-Installationen verwende ich {chruby-url}[Chruby].

*Ruby* sollte im Verzeichnis `/opt/rubies` oder `~/.rubies` installiert werden. +
Dann kann #chruby# automatisch die Installation verwalten.

*Step 1*: Auspacken des Source-Code
----
$ tar xzvf jruby-dist-9.2.5.0-bin.tar.gz -C /opt/rubies/
...
----

*Step 2*: Ziel-Verzeichnis überprüfen, Symbolischen Link erzeugen
----
$ ls -l /opt/rubies/   <1>
insgesamt 12
drwxr-sr-x 6 sid medien 4096 Dez  6 20:24 jruby-9.2.5.0
drwxr-xr-x 6 sid medien 4096 Dez 12 12:14 ruby-2.5.3

$ ln -s jruby /opt/rubies/jruby-9.2.5.0/bin/ruby   <2>
----
<1> Ziel-Verzeichnis.
<2> Symbolischen Link erzeugen.

*Step 3*: Installation verifizieren
----
$ ls -l /opt/rubies/jruby-9.2.5.0
drwxr-sr-x 2 sid medien   4096 Dez 15 22:18 bin       <1>
-rw-r--r-- 1 sid medien   1282 Dez  6 20:21 BSDL      <2>
-rw-r--r-- 1 sid medien 132268 Dez  6 20:21 COPYING
-rw-r--r-- 1 sid medien    218 Dez  6 20:21 LEGAL
drwxr-sr-x 4 sid medien   4096 Dez 15 22:17 lib
-rw-r--r-- 1 sid medien   2581 Dez  6 20:21 LICENSE.RUBY
drwxr-sr-x 6 sid medien   4096 Dez 15 22:17 samples
drwxr-sr-x 3 sid medien   4096 Dez 15 22:17 tool
----
<1> Datum der Installation.
<2> Release Date.

----
$ ls -l /opt/rubies/jruby-9.2.5.0/bin
-rwxr-xr-x 1 sid medien    5515 Dez  6 20:24 ast       <1>
-rw-r--r-- 1 sid medien      40 Dez  6 20:24 ast.bat   <2>
-rwxr-xr-x 1 sid medien     123 Dez  6 20:24 gem
-rw-r--r-- 1 sid medien      40 Dez  6 20:24 gem.bat
-rwxr-xr-x 1 sid medien     323 Dez  6 20:24 irb
-rw-r--r-- 1 sid medien      40 Dez  6 20:24 irb.bat
-rwxr-xr-x 1 sid medien     547 Dez  6 20:24 jgem
-rw-r--r-- 1 sid medien      41 Dez  6 20:24 jgem.bat
-rwxr-xr-x 1 sid medien     390 Dez  6 20:24 jirb
-rw-r--r-- 1 sid medien      41 Dez  6 20:24 jirb.bat
-rwxr-xr-x 1 sid medien    2263 Dez  6 20:24 jirb_swing
-rw-r--r-- 1 sid medien      47 Dez  6 20:24 jirb_swing.bat
-rwxr-xr-x 1 sid medien   13603 Dez  6 20:24 jruby
-rwxr-xr-x 1 sid medien     172 Dez  6 20:24 jruby200.sh
-rwxr-xr-x 1 sid medien   13603 Dez  6 20:24 jruby.bash
-rw-r--r-- 1 sid medien     125 Dez  6 20:24 jruby.bat
-rwxr-xr-x 1 sid medien     188 Dez  6 20:24 jrubyc
-rw-r--r-- 1 sid medien      43 Dez  6 20:24 jrubyc.bat
-rw-r--r-- 1 sid medien     245 Dez  6 20:24 jrubyd.bat
-rw-r--r-- 1 sid medien 1024512 Dez  6 20:24 jruby.dll
-rw-r--r-- 1 sid medien  959488 Dez  6 20:24 jruby.exe
-rwxr-xr-x 1 sid medien    9391 Dez  6 20:24 jruby.sh
-rw-r--r-- 1 sid medien  961536 Dez  6 20:24 jrubyw.exe
-rwxr-xr-x 1 sid medien     588 Dez  6 20:24 rake
-rw-r--r-- 1 sid medien      41 Dez  6 20:24 rake.bat
-rwxr-xr-x 1 sid medien     477 Dez  6 20:24 rdoc
-rw-r--r-- 1 sid medien      41 Dez  6 20:24 rdoc.bat
-rwxr-xr-x 1 sid medien     475 Dez  6 20:24 ri
-rw-r--r-- 1 sid medien      39 Dez  6 20:24 ri.bat
lrwxrwxrwx 1 sid medien       5 Dez 15 22:18 ruby -> jruby   <3>
-rwxr-xr-x 1 sid medien     152 Dez  6 20:24 testrb
-rw-r--r-- 1 sid medien      43 Dez  6 20:24 testrb.bat
----
<1> Kommando #ast# für ein _GNU/Linux-System_
<2> Kommando #ast.bat# für ein _MS Windows-System_
<3> Symbolischen Link in *Step 2* erzeugt!

*Step 4:* #chruby#
----
$ source /usr/local/share/chruby/chruby.sh

$ chruby
   jruby-9.2.5.0
   ruby-2.5.3

$ chruby jruby-9.2.5.0
----

[options="nowrap"]
----
$ jruby -v   <1>
jruby 9.2.5.0 (2.5.0) 2018-12-06 6d5a228 OpenJDK 64-Bit Server VM
                      10.0.2+13-Ubuntu-1ubuntu0.18.04.4
                      on 10.0.2+13-Ubuntu-1ubuntu0.18.04.4 +jit [linux-x86_64]
----
<1> Die Version *JRuby 9.2.5.0* &nbsp;
    _entspricht dem Entwicklungsstand von_ &nbsp; *Ruby 2.5.0*.

----
$ which gem
/opt/rubies/jruby-9.2.5.0/bin/gem

$ gem -v
2.7.6

$ gem list

*** LOCAL GEMS ***

cmath (default: 1.0.0)
csv (default: 1.0.0)
did_you_mean (1.2.0)
fileutils (default: 1.1.0)
ipaddr (default: 1.2.0)
jar-dependencies (default: 0.4.0)
jruby-openssl (default: 0.10.1 java)
jruby-readline (default: 1.3.7 java)
json (default: 2.1.0 java)
minitest (5.10.3)
net-telnet (0.1.1)
power_assert (1.1.3)
psych (default: 3.0.3 java)
rake (12.3.0)
rake-ant (default: 1.0.4)
rdoc (default: 6.0.1)
scanf (default: 1.0.0)
test-unit (3.2.8)
webrick (default: 1.4.2)
xmlrpc (0.3.0)
----

----
$ which rake
/opt/rubies/jruby-9.2.5.0/bin/rake

$ rake -V
rake, version 12.3.0
----

*Step 5* Vollständigkeit ...
----
$ jruby -ropenssl -rzlib -rreadline -e "puts 'Happy new Ruby'"
WARNING: An illegal reflective access operation has occurred     <1>
WARNING: Illegal reflective access by org.jruby.ext.openssl.SecurityHelper (file:/opt/rubies/jruby-9.2.5.0/lib/ruby/stdlib/jopenssl.jar) to constructor java.security.cert.CertificateFactory(java.security.cert.CertificateFactorySpi,java.security.Provider,java.lang.String)
WARNING: Please consider reporting this to the maintainers of org.jruby.ext.openssl.SecurityHelper
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
Happy new Ruby
----
<1> Siehe Tipp.

[TIP]
====
[options="nowrap"]
----
export JAVA_OPTS="--add-opens java.base/java.security.cert=ALL-UNNAMED --add-opens java.base/java.security=ALL-UNNAMED --add-opens java.base/java.util.zip=ALL-UNNAMED"
----
====


.JRuby 9.2.5.0: #irb#
----
$ which irb
/opt/rubies/jruby-9.2.5.0/bin/irb

$ irb
irb(main):001:0> RUBY_VERSION
=> "2.5.0"
irb(main):002:0> RUBY_PATCHLEVEL
=> 0
irb(main):003:0> Time.now.to_s
=> "2018-12-15 22:44:55 +0100"
irb(main):004:0> Time.now.sunday?
=> false
irb(main):005:0> exit
----

.ri - Ruby Interactive
----
$ ri Array#each   <1>
Nothing known about Array
----
<1> Dokumentation ist nicht installiert!

CAUTION: Ich war nicht in der Lage die _Ruby_-Dokumentation zu installieren.

== RubyGems
_RubyGems_ (oder kurz _Gems_) ist das offizielle Paketsystem für die
Programmiersprache Ruby. Mit dem Paketsystem hat der Anwender die Möglichkeit,
mehrere (zum Beispiel ältere oder jüngere) Versionen eines Programmes,
Programmteiles oder einer Bibliothek gesteuert nach Bedarf einzurichten,
zu verwalten oder auch wieder zu entfernen. +
&rarr; http://de.wikipedia.org/wiki/RubyGems[Wikipedia: RubyGems]

[CAUTION]
====
Einige _Gems_ (Bibliotheken) sind direkt in der Programmiersprache _C_
umgesetzt. Für _JRuby_ muß dann die entsprechende _Java_-Version
installiert werden. Das _Ruby_-Programm #gem# wird sie hierbei unterstützen.
====



=== _asciidoctor_
----
$ gem install asciidoctor coderay        <1> <2>
Fetching: asciidoctor-1.5.8.gem (100%)
Successfully installed asciidoctor-1.5.8
Fetching: coderay-1.1.2.gem (100%)
Successfully installed coderay-1.1.2
2 gems installed
----
<1> *Asciidoctor* ist die Neu-Implementation von *AsciiDoc* in Ruby. +
    *AsciiDoc* ist eine einfache Auszeichnungssprache, die dazu dient, +
    Texte in verschiedenen Dokumentenformaten zu veröffentlichen.
<2> *CodeRay* is a fast and easy syntax highlighting for selected languages, written in Ruby. +
    Comes with RedCloth integration and LOC counter.


=== _asciidoctor-revealjs_
----
$ gem install asciidoctor-revealjs   <1>
Fetching: thread_safe-0.3.6-java.gem (100%)
Successfully installed thread_safe-0.3.6-java
Fetching: asciidoctor-revealjs-1.1.3.gem (100%)
Successfully installed asciidoctor-revealjs-1.1.3
2 gems installed
----
<1> *Asciidoctor-Reveal.js* ist ein Konverter der ein *AsciiDoc*-Dokument
    in eine HTML5-Präsentation +
    umwandelt, um mit dem Framework *Reveal.js* ausgeführt zu werden.


=== _pry_
----
$ gem install pry   <1>
Fetching: method_source-0.9.2.gem (100%)
Successfully installed method_source-0.9.2
Fetching: ffi-1.9.25-java.gem (100%)
Successfully installed ffi-1.9.25-java
Fetching: spoon-0.0.6.gem (100%)
Successfully installed spoon-0.0.6
Fetching: pry-0.12.2-java.gem (100%)
Successfully installed pry-0.12.2-java   <2>
4 gems installed
----
<1> *Pry* is a powerful alternative to the standard *IRB* (Interactive Ruby) shell for Ruby.
<2> Es wurde automatisch die _Java_-Version von _pry_ installiert.


=== _sinatra_
----
$ gem install sinatra   <1>
Fetching: rack-2.0.6.gem (100%)
Successfully installed rack-2.0.6
Fetching: tilt-2.0.9.gem (100%)
Successfully installed tilt-2.0.9
Fetching: rack-protection-2.0.4.gem (100%)
Successfully installed rack-protection-2.0.4
Fetching: mustermann-1.0.3.gem (100%)
Successfully installed mustermann-1.0.3
Fetching: sinatra-2.0.4.gem (100%)
Successfully installed sinatra-2.0.4
5 gems installed
----
<1> *Sinatra* ist eine _freie_ und _open source Webapplikationsbibliothek_ und +
    eine in Ruby geschriebene _domänenspezifische_ Sprache. +
    *Sinatra* setzt das Rack Webserver-Interface voraus. +
    &rarr; http://de.wikipedia.org/wiki/Sinatra_%28Software%29[Wikipedia: Sinatra (Software)]


== RubyGems: _list_
.#gem list#
----
$ gem list

*** LOCAL GEMS ***

asciidoctor (1.5.8)            <1>
asciidoctor-revealjs (1.1.3)   <1>
cmath (default: 1.0.0)
coderay (1.1.2)                <1>
csv (default: 1.0.0)
did_you_mean (1.2.0)
ffi (1.9.25 java)              <1>
fileutils (default: 1.1.0)
ipaddr (default: 1.2.0)
jar-dependencies (default: 0.4.0)
jruby-openssl (default: 0.10.1 java)
jruby-readline (default: 1.3.7 java)
json (default: 2.1.0 java)
method_source (0.9.2)          <1>
minitest (5.10.3)
mustermann (1.0.3)             <1>
net-telnet (0.1.1)
power_assert (1.1.3)
pry (0.12.2 java)              <1>
psych (default: 3.0.3 java)
rack (2.0.6)                   <1>
rack-protection (2.0.4)        <1>
rake (12.3.0)
rake-ant (default: 1.0.4)
rdoc (default: 6.0.1)
scanf (default: 1.0.0)
sinatra (2.0.4)                <1>
spoon (0.0.6)                  <1>
test-unit (3.2.8)
thread_safe (0.3.6 java)       <1>
tilt (2.0.9)                   <1>
webrick (default: 1.4.2)
xmlrpc (0.3.0)
----
<1> 13 Gems zusätzlich installiert.


== RubyGems: _executable_
./opt/rubies/jruby-9.1.16.0/bin
----
$ ls -l /opt/rubies/jruby-9.2.5.0/bin   <1>
-rwxr-xr-x 1 sid medien    5515 Dez  6 20:24 ast
-rw-r--r-- 1 sid medien      40 Dez  6 20:24 ast.bat
-rwxr-xr-x 1 sid medien     123 Dez  6 20:24 gem
-rw-r--r-- 1 sid medien      40 Dez  6 20:24 gem.bat
...
-rwxr-xr-x 1 sid medien     475 Dez  6 20:24 ri
-rw-r--r-- 1 sid medien      39 Dez  6 20:24 ri.bat
lrwxrwxrwx 1 sid medien       5 Dez 15 22:18 ruby -> jruby
-rwxr-xr-x 1 sid medien     152 Dez  6 20:24 testrb
-rw-r--r-- 1 sid medien      43 Dez  6 20:24 testrb.bat
----
<1> Keine Veränderung im Installations-Verzeichnis!

.~/.gem/jruby/2.5.0/bin
----
$ ls -l ~/.gem/jruby/2.5.0/bin   <1>
-rwxr-xr-x 1 sid sid 630 Dez 15 22:54 asciidoctor
-rwxr-xr-x 1 sid sid 684 Dez 15 22:58 asciidoctor-revealjs
-rwxr-xr-x 1 sid sid 640 Dez 15 22:54 asciidoctor-safe
-rwxr-xr-x 1 sid sid 606 Dez 15 22:55 coderay
-rwxr-xr-x 1 sid sid 582 Dez 15 23:00 pry
-rwxr-xr-x 1 sid sid 592 Dez 15 23:02 rackup
-rwxr-xr-x 1 sid sid 588 Dez 15 23:02 tilt
----
<1> Mit *chruby* werden die zusätzlichen _RubyGems_ im
    Home-Verzeichnis installiert. +

CAUTION: Das Verzeichnis `~/.gem/jruby/2.5.0/...` -- entspricht der _Ruby_-Version -- nicht der _JRuby_-Version!


== RubyGems Documentation Index
Auf die installierte Dokumentation zugreifen.
----
# gem server
Server started at http://0.0.0.0:8808
----

----
Browser> http://localhost:8808/
         RubyGems Documentation Index
----

image:jruby/rubygems_documentation_index_9k.png[RubyGems Documentation Index]




include::_bp_footer.adoc[]
